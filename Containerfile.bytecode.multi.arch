## see https://go.dev/doc/install/source#environment for valid
## GOARCHes when GOOS=linux.
FROM scratch
ARG TARGETARCH
ARG TARGETOS

FROM scratch AS linuxamd64
ARG TARGETARCH
ARG TARGETOS
ARG BC_AMD64_EL
COPY $BC_AMD64_EL /

FROM scratch AS linuxarm64
ARG TARGETARCH
ARG TARGETOS
ARG BC_ARM64_EL
COPY $BC_ARM64_EL /

FROM scratch AS linuxppc64le
ARG TARGETARCH
ARG TARGETOS
ARG BC_PPC64LE_EL
COPY $BC_PPC64LE_EL /

FROM scratch AS linuxs390x
ARG TARGETARCH
ARG TARGETOS
ARG BC_S390X_EB
COPY $BC_S390X_EB /

ARG TARGETARCH
ARG TARGETOS

# Use the build argument to select the correct base image
FROM ${TARGETOS}${TARGETARCH}
ARG PROGRAMS
ARG MAPS
LABEL "io.ebpf.programs"=$PROGRAMS
LABEL "io.ebpf.maps"=$MAPS
